#######################################
#####          cutsom_acl         #####
#######################################
acl/custom_acl_table/test_custom_acl_table.py:
  skip:
    reason: "Custom ACL not supported on older releases or dualtor setup"
    conditions_logical_operator: or
    conditions:
      - "release in ['201811', '201911', '202012']"
      - "'dualtor' in topo_name"

#######################################
#####            acl              #####
#######################################
acl/null_route/test_null_route_helper.py:
  skip:
    reason: "Skip running on dualtor testbed"
    conditions:
      - "'dualtor' in topo_name"

acl/test_acl.py:
  xfail:
    reason: "ACL test is not supported on mellanox platform with dualtor topology "
    conditions:
      - "asic_type in ['mellanox'] and 'dualtor' in topo_name"

acl/test_acl_outer_vlan.py:
  #Outer VLAN id match support is planned for future release with SONIC on Cisco 8000
  #For the current release, will mark the related test cases as XFAIL
  xfail:
    reason: "Cisco platform does not support ACL Outer VLAN ID tests"
    conditions:
      - "asic_type in ['cisco-8000']"
  skip:
    reason: "Skip running on dualtor testbed"
    conditions:
      - "'dualtor' in topo_name"

#######################################
#####            arp              #####
#######################################
arp/test_arp_dualtor.py::test_proxy_arp_for_standby_neighbor:
  skip:
    reason: "`accept_untracked_na` currently only available in 202012"
    conditions:
      - "release not in ['202012']"

arp/test_neighbor_mac_noptf.py:
  skip:
    reason: "Not supported in standalone topologies."
    conditions:
      - "'standalone' in topo_name"

arp/test_unknown_mac.py:
  skip:
    reason: "Behavior on cisco-8000 & Innovium(Marvell) platform for unknown MAC is flooding rather than DROP, hence skipping."
    conditions:
      - "asic_type in ['cisco-8000','innovium']"

arp/test_wr_arp.py:
  skip:
    reason: "Warm reboot is broken on dualtor topology. Device fails to recover by sanity check. Skipping for now. Not supported in standalone topos"
    conditions_logical_operator: or
    conditions:
      - "https://github.com/sonic-net/sonic-buildimage/issues/16502 and 'dualtor' in topo_name"
      - "'standalone' in topo_name"

#######################################
#####            bfd              #####
#######################################
bfd/test_bfd.py:
  skip:
    reason: "Test not supported for platforms other than Nvidia 4600c/4700/5600 and cisco-8102. Skipping the test"
    conditions:
      -  "(release in ['201811', '201911']) or (platform not in ['x86_64-mlnx_msn4600c-r0', 'x86_64-mlnx_msn4700-r0', 'x86_64-nvidia_sn5600-r0', 'x86_64-8102_64h_o-r0', 'x86_64-8101_32fh_o-r0'])"

bfd/test_bfd.py::test_bfd_basic:
  skip:
    reason: "Test not supported for cisco as it doesnt support single hop BFD
             and not supported for platforms other than Nvidia 4600c/4700/5600. Skipping the test"
    conditions_logical_operator: or
    conditions:
      - "platform in ['x86_64-8102_64h_o-r0', 'x86_64-8101_32fh_o-r0', 'x86_64-8111_32eh_o-r0', 'x86_64-8122_64eh_o-r0', 'x86_64-8122_64ehf_o-r0']"
      - "platform not in ['x86_64-mlnx_msn4600c-r0', 'x86_64-mlnx_msn4700-r0', 'x86_64-nvidia_sn5600-r0', 'x86_64-8102_64h_o-r0', 'x86_64-8101_32fh_o-r0']"
      - "release in ['201811', '201911']"

bfd/test_bfd.py::test_bfd_scale:
  skip:
    reason: "Test not supported for cisco as it doesnt support single hop BFD.
             and not supported for platforms other than Nvidia 4600c/4700/5600. Skipping the test"
    conditions_logical_operator: or
    conditions:
      - "platform in ['x86_64-8102_64h_o-r0', 'x86_64-8101_32fh_o-r0', 'x86_64-8111_32eh_o-r0', 'x86_64-8122_64eh_o-r0', 'x86_64-8122_64ehf_o-r0']"
      - "platform not in ['x86_64-mlnx_msn4600c-r0', 'x86_64-mlnx_msn4700-r0', 'x86_64-nvidia_sn5600-r0', 'x86_64-8102_64h_o-r0', 'x86_64-8101_32fh_o-r0']"
      - "release in ['201811', '201911']"

bfd/test_bfd_static_route.py:
  skip:
    reason: "Only supported on multi-asic system & Cisco LCs."
    conditions:
      - "(is_multi_asic is False) or (hwsku not in ['Cisco-88-LC0-36FH-M-O36', 'Cisco-8800-LC-48H-C48', 'Cisco-88-LC0-36FH-O36'])"

bfd/test_bfd_traffic.py:
  skip:
    reason: "Test only supported on Cisco 8800 platforms."
    conditions:
      - "asic_type not in ['cisco-8000']"

#######################################
#####            bgp              #####
#######################################
bgp/test_bgp_allow_list.py:
  skip:
    reason: "Only supported on t1 topo. But Cisco 8111 T1(compute ai) platform is not supported."
    conditions_logical_operator: or
    conditions:
      - "'t1' not in topo_type"
      - "platform in ['x86_64-8111_32eh_o-r0']"

bgp/test_bgp_bbr.py:
  skip:
    reason: "Only supported on t1 topo. But Cisco 8111 T1(compute ai) platform is not supported."
    conditions_logical_operator: or
    conditions:
      - "'t1' not in topo_type"
      - "platform in ['x86_64-8111_32eh_o-r0']"

bgp/test_bgp_gr_helper.py:
  skip:
    reason: 'bgp graceful restarted is not a supported feature for T2'
    conditions:
      - "'t2' in topo_name"

bgp/test_bgp_multipath_relax.py:
  skip:
    reason: "Not supported topology backend."
    conditions:
      - "'backend' in topo_name"

bgp/test_bgp_queue.py:
  skip:
    reason: "Not supported on mgmt device"
    conditions:
      - "topo_type in ['m0', 'mx']"

bgp/test_bgp_slb.py:
  skip:
    reason: "Skip over topologies which doesn't support slb."
    conditions:
     - "'backend' in topo_name or 'mgmttor' in topo_name"

bgp/test_bgp_slb.py::test_bgp_slb_neighbor_persistence_across_advanced_reboot:
  skip:
    reason: "Skip it on dual tor since it got stuck during warm reboot due to known issue on master and internal image
             or over topologies which doesn't support slb."
    conditions_logical_operator: or
    conditions:
      - "topo_name in ['dualtor', 'dualtor-56', 'dualtor-120', 'dualtor-aa', 'dualtor-aa-56'] and 'https://github.com/sonic-net/sonic-mgmt/issues/9201'"
      - "'backend' in topo_name or 'mgmttor' in topo_name"

bgp/test_bgp_speaker.py:
  skip:
    reason: "Not supported on topology backend."
    conditions:
      - "'backend' in topo_name"

bgp/test_bgp_suppress_fib.py:
  skip:
    reason: "Not supported before release 202411."
    conditions_logical_operator: or
    conditions:
      - "release in ['201811', '201911', '202012', '202205', '202211', '202305', '202311', '202405', 'master']"
      - "asic_type in ['vs'] and https://github.com/sonic-net/sonic-mgmt/issues/14449"

bgp/test_bgpmon.py:
  skip:
    reason: "Not supported on T2 topology or topology backend"
    conditions:
      - "'backend' in topo_name or 't2' in topo_name"

bgp/test_traffic_shift.py::test_load_minigraph_with_traffic_shift_away:
  skip:
    reason: "Test is flaky and causing PR test to fail unnecessarily"
    conditions:
      - "asic_type in ['vs']"
      - https://github.com/sonic-net/sonic-mgmt/issues/6471

#######################################
#####            cacl             #####
#######################################
cacl/test_cacl_application.py::test_cacl_application_dualtor:
  skip:
    reason: "test_cacl_application_dualtor is only supported on dualtor topology"
    conditions:
      - "topo_name not in ['dualtor', 'dualtor-56', 'dualtor-64', 'dualtor-64-breakout', 'dualtor-120']"

cacl/test_cacl_application.py::test_cacl_application_nondualtor:
  skip:
    reason: "test_cacl_application is only supported on non dualtor topology"
    conditions:
      - "topo_name in ['dualtor', 'dualtor-56', 'dualtor-64', 'dualtor-120']"

cacl/test_cacl_application.py::test_multiasic_cacl_application:
  skip:
    reason: "test_multiasic_cacl_application is only supported on multi-ASIC platform"
    conditions:
      - "not is_multi_asic"

#######################################
#####           configlet         #####
#######################################
configlet/test_add_rack.py:
  skip:
    reason: "AddRack is not yet supported on multi-ASIC platform"
    conditions:
      - "is_multi_asic==True"

container_hardening/test_container_hardening.py::test_container_privileged:
  skip:
    reason: "Not supported on 202305 and older releases"
    conditions:
      - "release in ['201811', '201911', '202012', '202205', '202211', '202305']"

#######################################
#####            copp             #####
#######################################
copp/test_copp.py:
  skip:
    reason: "Topology not supported by COPP tests"
    conditions:
      - "(topo_name not in ['ptf32', 'ptf64', 't0', 't0-64', 't0-52', 't0-116', 't1', 't1-lag', 't1-64-lag', 't1-56-lag', 't1-backend', 'm0', 'm0-2vlan', 'mx'] and 't2' not in topo_type)"

copp/test_copp.py::TestCOPP::test_add_new_trap:
  skip:
    reason: "Copp test_add_new_trap is not yet supported on these testbeds"
    conditions_logical_operator: or
    conditions:
      - "is_multi_asic==True"
      - "(topo_name not in ['ptf32', 'ptf64', 't0', 't0-64', 't0-52', 't0-116', 't1', 't1-lag', 't1-64-lag', 't1-56-lag', 't1-backend', 'm0', 'm0-2vlan', 'mx'] and 't2' not in topo_type)"

copp/test_copp.py::TestCOPP::test_remove_trap:
  skip:
    reason: "Copp test_remove_trap is not yet supported on these testbeds"
    conditions_logical_operator: or
    conditions:
      - "is_multi_asic==True"
      - "(topo_name not in ['ptf32', 'ptf64', 't0', 't0-64', 't0-52', 't0-116', 't1', 't1-lag', 't1-64-lag', 't1-56-lag', 't1-backend', 'm0', 'm0-2vlan', 'mx'] and 't2' not in topo_type)"

copp/test_copp.py::TestCOPP::test_trap_config_save_after_reboot:
  skip:
    conditions_logical_operator: or
    reason: "Copp test_trap_config_save_after_reboot is not yet supported on these testbeds or not supported after docker_inram enabled"
    conditions:
      - "is_multi_asic==True"
      - "build_version.split('.')[0].isdigit() and int(build_version.split('.')[0]) == 20220531 and int(build_version.split('.')[1]) > 27 and hwsku in ['Arista-7050-QX-32S', 'Arista-7050QX32S-Q32', 'Arista-7050-QX32', 'Arista-7050QX-32S-S4Q31', 'Arista-7060CX-32S-D48C8', 'Arista-7060CX-32S-C32', 'Arista-7060CX-32S-Q32', 'Arista-7060CX-32S-C32-T1']"
      - "build_version.split('.')[0].isdigit() and int(build_version.split('.')[0]) > 20220531 and hwsku in ['Arista-7050-QX-32S', 'Arista-7050QX32S-Q32', 'Arista-7050-QX32', 'Arista-7050QX-32S-S4Q31', 'Arista-7060CX-32S-D48C8', 'Arista-7060CX-32S-C32', 'Arista-7060CX-32S-Q32', 'Arista-7060CX-32S-C32-T1']"
      - "(topo_name not in ['ptf32', 'ptf64', 't0', 't0-64', 't0-52', 't0-116', 't1', 't1-lag', 't1-64-lag', 't1-56-lag', 't1-backend', 'm0', 'm0-2vlan', 'mx'] and 't2' not in topo_type)"


#######################################
#####            crm              #####
#######################################
crm/test_crm.py::test_crm_fdb_entry:
  skip:
    reason: "Unsupported topology, expected to run only on 'T0*' or 'M0/MX' topology"
    conditions:
      - "'t0' not in topo_name and topo_type not in ['m0', 'mx']"

#######################################
#####            decap            #####
#######################################
decap/test_decap.py::test_decap[ttl=pipe, dscp=pipe, vxlan=disable]:
  skip:
    reason: "Not supported on broadcom after 201911 release, mellanox all releases and cisco-8000 all releases and marvell asics"
    conditions:
      - "(asic_type in ['broadcom'] and release not in ['201811', '201911']) or (asic_type in ['mellanox']) or (asic_type in ['cisco-8000'])"

decap/test_decap.py::test_decap[ttl=pipe, dscp=pipe, vxlan=set_unset]:
  skip:
    reason: "Not supported on broadcom after 201911 release, mellanox all releases and cisco-8000 all releases and marvell asics"
    conditions:
      - "(asic_type in ['broadcom'] and release not in ['201811', '201911']) or (asic_type in ['mellanox']) or (asic_type in ['cisco-8000']) or (asic_type in ['marvell'])"

decap/test_decap.py::test_decap[ttl=pipe, dscp=uniform, vxlan=disable]:
  skip:
    conditions_logical_operator: or
    reason: "Not supported on backend, broadcom before 202012 release, innovium platform. Skip 7260CX3 T1 topo in 202305 release"
    conditions:
      - "(topo_name in ['t1-backend', 't0-backend']) or (asic_type in ['broadcom'] and release in ['201811', '201911']) or asic_type in ['innovium']"
      - "'7260CX3' in hwsku and release in ['202305'] and 't1' in topo_type"

decap/test_decap.py::test_decap[ttl=pipe, dscp=uniform, vxlan=set_unset]:
  skip:
    reason: "Not supported on backend, T2 topologies , broadcom platforms before 202012 release, innovium, x86_64-8111_32eh_o-r0 platform. Skip on mellanox dualtor setups for github issue #9646. Skip on 7260CX3 T1 topo in 202305 release"
    conditions_logical_operator: or
    conditions:
      - "('t2' in topo_name) or (topo_name in ['t1-backend', 't0-backend']) or (asic_type in ['broadcom'] and release in ['201811', '201911']) or asic_type in ['innovium'] or platform in ['x86_64-8111_32eh_o-r0']"
      - "https://github.com/sonic-net/sonic-mgmt/issues/9646 and 'dualtor' in topo_name and asic_type in ['mellanox']"
      - "'7260CX3' in hwsku and release in ['202305'] and 't1' in topo_type"

decap/test_decap.py::test_decap[ttl=uniform, dscp=pipe, vxlan=disable]:
  skip:
    reason: "Not supported uniform ttl mode"

decap/test_decap.py::test_decap[ttl=uniform, dscp=pipe, vxlan=set_unset]:
  skip:
    reason: "Not supported uniform ttl mode"

decap/test_decap.py::test_decap[ttl=uniform, dscp=uniform, vxlan=disable]:
  skip:
    reason: "Not supported uniform ttl mode"

decap/test_decap.py::test_decap[ttl=uniform, dscp=uniform, vxlan=set_unset]:
  skip:
    reason: "Not supported uniform ttl mode"

decap/test_subnet_decap.py::test_vlan_subnet_decap:
  skip:
    reason: "Supported only on T0 topology with KVM or broadcom td3 asic, and available for 202405 release and later"
    conditions:
      - "topo_type not in ['t0']"
      - "asic_type not in ['vs'] or asic_gen not in ['td3']"
      - "release in ['202012', '202205', '202305', '202311']"

#######################################
#####         dhcp_relay        #####
#######################################
dhcp_relay/test_dhcp_relay.py:
  skip:
    reason: "Need to skip for platform x86_64-8111_32eh_o-r0"
    conditions:
      - "platform in ['x86_64-8111_32eh_o-r0']"

dhcp_relay/test_dhcp_relay.py::test_dhcp_relay_after_link_flap:
  skip:
    reason: "Skip test_dhcp_relay_after_link_flap on dualtor or platform x86_64-8111_32eh_o-r0"
    conditions_logical_operator: or
    conditions:
      - "'dualtor' in topo_name"
      - "platform in ['x86_64-8111_32eh_o-r0']"

dhcp_relay/test_dhcp_relay.py::test_dhcp_relay_random_sport:
  skip:
    reason: "Skip test_dhcp_relay_random_sport on dualtor in 201811 and 201911 or platform x86_64-8111_32eh_o-r0"
    conditions_logical_operator: or
    conditions:
      - "'dualtor' in topo_name and release in ['201811', '201911']"
      - "platform in ['x86_64-8111_32eh_o-r0']"

dhcp_relay/test_dhcp_relay.py::test_dhcp_relay_start_with_uplinks_down:
  skip:
    reason: "Skip test_dhcp_relay_start_with_uplinks_down on dualtor or platform x86_64-8111_32eh_o-r0"
    conditions_logical_operator: or
    conditions:
      - "'dualtor' in topo_name"
      - "platform in ['x86_64-8111_32eh_o-r0']"

dhcp_relay/test_dhcp_relay.py::test_dhcp_relay_unicast_mac:
  skip:
    reason: "Skip test_dhcp_relay_unicast_mac on dualtor or platform x86_64-8111_32eh_o-r0"
    conditions_logical_operator: or
    conditions:
      - "'dualtor' in topo_name and release in ['201811', '201911']"
      - "platform in ['x86_64-8111_32eh_o-r0']"

dhcp_relay/test_dhcpv6_relay.py:
  skip:
    reason: "Need to skip for platform x86_64-8111_32eh_o-r0"
    conditions:
      - "platform in ['x86_64-8111_32eh_o-r0']"

dhcp_relay/test_dhcpv6_relay.py::TestDhcpv6RelayWithMultipleVlan:
  skip:
    reason: "skip the multiple vlan test on aa dualtor as interface state is not aa after vlan split"
    conditions:
      - "'dualtor-aa' in topo_name"

#######################################
#####         drop_packets        #####
#######################################
drop_packets:
  skip:
    reason: "M0/MX topo does not support drop_packets"
    conditions:
      - "topo_type in ['m0', 'mx']"

#######################################
#####           dualtor           #####
#######################################
dualtor/test_ipinip.py::test_encap_with_mirror_session:
  xfail:
     reason: "Testcase ignored on dualtor-aa topology and mellanox setups due to Github issue: https://github.com/sonic-net/sonic-mgmt/issues/8577"
     conditions:
       - https://github.com/sonic-net/sonic-mgmt/issues/8577
       - "'dualtor-aa' in topo_name and asic_type in ['mellanox']"

dualtor/test_orch_stress.py:
  skip:
    reason: "This testcase is designed for single tor testbed with mock dualtor config."
    conditions:
      - "(topo_type not in ['t0']) or ('dualtor' in topo_name)"

dualtor/test_orchagent_active_tor_downstream.py:
  skip:
    reason: "This testcase is designed for single tor testbed with mock dualtor config."
    conditions:
      - "(topo_type not in ['t0']) or ('dualtor' in topo_name)"

dualtor/test_orchagent_active_tor_downstream.py::test_downstream_ecmp_nexthops:
  skip:
    reason: "On Mellanox SPC1 platforms, due to HW limitation, the hierarchy ecmp behavior is not exactly as expected
             in the test case. / This testcase is designed for single tor testbed with mock dualtor config."
    conditions_logical_operator: or
    conditions:
      - "asic_gen == 'spc1'"
      - "(topo_type not in ['t0']) or ('dualtor' in topo_name)"

dualtor/test_orchagent_mac_move.py:
  skip:
    reason: "This testcase is designed for single tor testbed with mock dualtor config."
    conditions:
      - "(topo_type not in ['t0']) or ('dualtor' in topo_name)"

dualtor/test_orchagent_standby_tor_downstream.py::test_downstream_standby_mux_toggle_active:
  skip:
    reason: "This testcase is designed for single tor testbed with mock dualtor config."
    conditions:
      - "(topo_type not in ['t0']) or ('dualtor' in topo_name)"
  xfail:
    reason: "Image issue on Boradcom platforms, but not consistently failing"
    conditions:
      - "asic_type in ['broadcom']"

dualtor/test_orchagent_standby_tor_downstream.py::test_standby_tor_downstream:
  skip:
    reason: "This testcase is designed for single tor testbed with mock dualtor config."
    conditions:
      - "(topo_type not in ['t0']) or ('dualtor' in topo_name)"

dualtor/test_orchagent_standby_tor_downstream.py::test_standby_tor_downstream_bgp_recovered:
  skip:
    reason: "This testcase is designed for single tor testbed with mock dualtor config."
    conditions:
      - "(topo_type not in ['t0']) or ('dualtor' in topo_name)"

dualtor/test_orchagent_standby_tor_downstream.py::test_standby_tor_downstream_loopback_route_readded:
  skip:
    reason: "This testcase is designed for single tor testbed with mock dualtor config and dualtor."
    conditions:
      - "(topo_type not in ['t0'])"

dualtor/test_orchagent_standby_tor_downstream.py::test_standby_tor_downstream_t1_link_recovered:
  skip:
    reason: "This testcase is designed for single tor testbed with mock dualtor config."
    conditions:
      - "(topo_type not in ['t0']) or ('dualtor' in topo_name)"

dualtor/test_orchagent_standby_tor_downstream.py::test_standby_tor_remove_neighbor_downstream_standby:
  skip:
    reason: "This testcase is designed for single tor testbed with mock dualtor config."
    conditions:
      - "(topo_type not in ['t0']) or ('dualtor' in topo_name)"

dualtor/test_standby_tor_upstream_mux_toggle.py:
  skip:
    reason: "This testcase is designed for single tor testbed with mock dualtor config."
    conditions:
      - "(topo_type not in ['t0']) or ('dualtor' in topo_name)"

dualtor/test_switchover_failure.py:
  skip:
    reason: "Test in KVM has a high failure rate, skip with Github issue."
    conditions:
      - "asic_type in ['vs']"
      - https://github.com/sonic-net/sonic-mgmt/issues/14247

dualtor/test_tor_ecn.py::test_dscp_to_queue_during_encap_on_standby:
  xfail:
     reason: "Testcase ignored on dualtor-aa topology and mellanox setups due to Github issue: https://github.com/sonic-net/sonic-mgmt/issues/8577"
     conditions:
       - https://github.com/sonic-net/sonic-mgmt/issues/8577
       - "'dualtor-aa' in topo_name and asic_type in ['mellanox']"

dualtor/test_tor_ecn.py::test_ecn_during_encap_on_standby:
  xfail:
     reason: "Testcase ignored on dualtor-aa topology and mellanox setups due to Github issue: https://github.com/sonic-net/sonic-mgmt/issues/8577"
     conditions:
       - https://github.com/sonic-net/sonic-mgmt/issues/8577
       - "'dualtor-aa' in topo_name and asic_type in ['mellanox']"

dualtor/test_tunnel_memory_leak.py::test_tunnel_memory_leak:
  skip:
    reason: "Testcase ignored on dualtor-64 topology due to Github issue: https://github.com/sonic-net/sonic-mgmt/issues/11403"
    conditions:
      - "https://github.com/sonic-net/sonic-mgmt/issues/11403 and 'dualtor-64' in topo_name"

dualtor_io:
  skip:
    reason: "Testcase could only be executed on dualtor testbed."
    conditions:
      - "'dualtor' not in topo_name"

dualtor_io/test_link_failure.py::test_active_link_admin_down_config_reload_link_up_downstream_standby[active-active]:
  xfail:
    reason: "Testcase ignored on mellanox setups due to github issue: https://github.com/sonic-net/sonic-buildimage/issues/16161"
    conditions:
      - "https://github.com/sonic-net/sonic-buildimage/issues/16161 and asic_type in ['mellanox']"

dualtor_io/test_link_failure.py::test_active_link_down_downstream_active:
  xfail:
    reason: "Testcase ignored on Nvidia platforms due to github issue: https://github.com/sonic-net/sonic-mgmt/issues/8272"
    conditions:
      - https://github.com/sonic-net/sonic-mgmt/issues/8272
      - "asic_type in ['mellanox']"
  skip:
    reason: "KVM testbed do not support shutdown fanout interface action / Testcase could only be executed on dualtor testbed."
    conditions:
      - "asic_type in ['vs'] or 'dualtor' not in topo_name"

dualtor_io/test_link_failure.py::test_active_link_down_downstream_active_soc:
  xfail:
    reason: "Testcase ignored on Nvidia platforms due to github issue: https://github.com/sonic-net/sonic-mgmt/issues/8272"
    conditions:
      - https://github.com/sonic-net/sonic-mgmt/issues/8272
      - "asic_type in ['mellanox']"
  skip:
    reason: "KVM testbed do not support shutdown fanout interface action / Testcase could only be executed on dualtor testbed."
    conditions:
      - "asic_type in ['vs'] or 'dualtor' not in topo_name"

dualtor_io/test_link_failure.py::test_active_link_down_downstream_standby:
  xfail:
    reason: "Testcase ignored on Nvidia platforms due to github issue: https://github.com/sonic-net/sonic-mgmt/issues/8272"
    conditions:
      - https://github.com/sonic-net/sonic-mgmt/issues/8272
      - "asic_type in ['mellanox']"
  skip:
    reason: "KVM testbed do not support shutdown fanout interface action / Testcase could only be executed on dualtor testbed."
    conditions:
      - "asic_type in ['vs'] or 'dualtor' not in topo_name"

dualtor_io/test_link_failure.py::test_active_link_down_upstream:
  skip:
    reason: "KVM testbed do not support shutdown fanout interface action / Testcase could only be executed on dualtor testbed."
    conditions:
      - "asic_type in ['vs'] or 'dualtor' not in topo_name"

dualtor_io/test_link_failure.py::test_active_link_down_upstream_soc:
  skip:
    reason: "KVM testbed do not support shutdown fanout interface action / Testcase could only be executed on dualtor testbed."
    conditions:
      - "asic_type in ['vs'] or 'dualtor' not in topo_name"

dualtor_io/test_link_failure.py::test_standby_link_down_downstream_active:
  skip:
    reason: "KVM testbed do not support shutdown fanout interface action / Testcase could only be executed on dualtor testbed."
    conditions:
      - "asic_type in ['vs'] or 'dualtor' not in topo_name"

dualtor_io/test_link_failure.py::test_standby_link_down_downstream_standby:
  skip:
    reason: "KVM testbed do not support shutdown fanout interface action / Testcase could only be executed on dualtor testbed."
    conditions:
      - "asic_type in ['vs'] or 'dualtor' not in topo_name"

dualtor_io/test_link_failure.py::test_standby_link_down_upstream:
  skip:
    reason: "KVM testbed do not support shutdown fanout interface action / Testcase could only be executed on dualtor testbed."
    conditions:
      - "asic_type in ['vs'] or 'dualtor' not in topo_name"

dualtor_mgmt/test_dualtor_bgp_update_delay.py:
  xfail:
    reason: "Has flaky issue on kvm testbed"
    conditions:
      - asic_type in ['vs']
      - https://github.com/sonic-net/sonic-mgmt/issues/14996

#######################################
#####         dut_console         #####
#######################################
dut_console:
  skip:
    reason: "Not supported vs testbed."
    conditions:
      - "asic_type in ['vs']"

#######################################
#####             ecmp            #####
#######################################
ecmp/inner_hashing/test_inner_hashing.py:
  skip:
    conditions_logical_operator: or
    reason: "PBH introduced in 202111 and skip this test on Mellanox 2700 platform. Test does not support dualtor topology."
    conditions:
      - "branch in ['201811', '201911', '202012', '202106']"
      - "platform not in ['x86_64-mlnx_msn3800-r0', 'x86_64-mlnx_msn4600c-r0', 'x86_64-kvm_x86_64-r0']"
      - "topo_type not in ['t0']"
      - "asic_type not in ['mellanox', 'vs']"
      - "'dualtor' in topo_name"

ecmp/inner_hashing/test_inner_hashing_lag.py:
  skip:
    conditions_logical_operator: or
    reason: "PBH introduced in 202111 and skip this test on Mellanox 2700 platform. Test does not support dualtor topology."
    conditions:
      - "branch in ['201811', '201911', '202012', '202106']"
      - "platform not in ['x86_64-mlnx_msn3800-r0', 'x86_64-mlnx_msn4600c-r0', 'x86_64-kvm_x86_64-r0']"
      - "topo_type not in ['t0']"
      - "asic_type not in ['mellanox', 'vs']"
      - "'dualtor' in topo_name"

ecmp/inner_hashing/test_wr_inner_hashing.py:
  skip:
    conditions_logical_operator: or
    reason: "PBH introduced in 202111 and skip this test on Mellanox 2700 platform. Test does not support dualtor topology."
    conditions:
      - "branch in ['201811', '201911', '202012', '202106']"
      - "platform not in ['x86_64-mlnx_msn3800-r0', 'x86_64-mlnx_msn4600c-r0', 'x86_64-kvm_x86_64-r0']"
      - "topo_type not in ['t0']"
      - "asic_type not in ['mellanox', 'vs']"
      - "'dualtor' in topo_name"

ecmp/inner_hashing/test_wr_inner_hashing_lag.py:
  skip:
    conditions_logical_operator: or
    reason: "PBH introduced in 202111 and skip this test on Mellanox 2700 platform. Test does not support dualtor topology."
    conditions:
      - "branch in ['201811', '201911', '202012', '202106']"
      - "platform not in ['x86_64-mlnx_msn3800-r0', 'x86_64-mlnx_msn4600c-r0', 'x86_64-kvm_x86_64-r0']"
      - "topo_type not in ['t0']"
      - "asic_type not in ['mellanox', 'vs']"
      - "'dualtor' in topo_name"

ecmp/test_ecmp_sai_value.py:
  skip:
    reason: "Only support Broadcom T1/T0 topology with 20230531 and above image, 7050cx3 T1 doesn't enable this feature"
    conditions_logical_operator: or
    conditions:
      - "topo_type not in ['t1', 't0']"
      - "asic_type not in ['broadcom']"
      - "release in ['201911', '202012', '202205', '202211']"
      - "topo_type in ['t1'] and hwsku in ['Arista-7050CX3-32S-C32']"

ecmp/test_fgnhg.py:
  skip:
    conditions_logical_operator: or
    reason: "The test case only runs on Mellanox T0 platform running 202012 or above; Mellanox 2700 platform is skipped; Skip on issue 7755"
    conditions:
      - "branch in ['201811', '201911']"
      - "platform in ['x86_64-mlnx_msn2700-r0', 'x86_64-mlnx_msn2700a1-r0']"
      - "topo_type not in ['t0']"
      - "asic_type not in ['mellanox']"
      - "https://github.com/sonic-net/sonic-mgmt/issues/7755"
      - "https://github.com/sonic-net/sonic-mgmt/issues/6558 and 'msn2' in platform"

#######################################
#####         everflow            #####
#######################################
everflow/test_everflow_per_interface.py:
  skip:
    reason: "Skip running on dualtor testbed/unsupported platforms or
                  multi-asic due to https://github.com/sonic-net/sonic-buildimage/issues/11776"
    conditions_logical_operator: or
    conditions:
      - "'dualtor' in topo_name"
      - "platform in ['x86_64-8800_lc_48h_o-r0', 'x86_64-8800_lc_48h-r0']"
      - "(is_multi_asic==True) and https://github.com/sonic-net/sonic-buildimage/issues/11776"

everflow/test_everflow_per_interface.py::test_everflow_per_interface[ipv6-default]:
  skip:
    reason: "Skip everflow per interface IPv6 test on unsupported platforms"
    conditions_logical_operator: or
    conditions:
      - "asic_type in ['cisco-8000', 'marvell', 'mellanox'] or (asic_subtype in ['broadcom-dnx'] and https://github.com/sonic-net/sonic-swss/issues/2204)"
      - "'dualtor' in topo_name"
      - "platform in ['x86_64-8800_lc_48h_o-r0', 'x86_64-8800_lc_48h-r0']"
      - "(is_multi_asic==True) and https://github.com/sonic-net/sonic-buildimage/issues/11776"

everflow/test_everflow_per_interface.py::test_everflow_per_interface[ipv6-m0_l3_scenario]:
  skip:
    reason: "Skip m0 everflow per interface IPv6 test on unsupported platforms"
    conditions_logical_operator: or
    conditions:
      - "asic_type in ['marvell']"
      - "'dualtor' in topo_name"
      - "platform in ['x86_64-8800_lc_48h_o-r0', 'x86_64-8800_lc_48h-r0']"
      - "(is_multi_asic==True) and https://github.com/sonic-net/sonic-buildimage/issues/11776"

everflow/test_everflow_per_interface.py::test_everflow_per_interface[ipv6-m0_vlan_scenario]:
  skip:
    reason: "Skip m0 everflow per interface IPv6 test on unsupported platforms"
    conditions_logical_operator: or
    conditions:
      - "asic_type in ['marvell']"
      - "'dualtor' in topo_name"
      - "platform in ['x86_64-8800_lc_48h_o-r0', 'x86_64-8800_lc_48h-r0']"
      - "(is_multi_asic==True) and https://github.com/sonic-net/sonic-buildimage/issues/11776"

everflow/test_everflow_testbed.py::EverflowIPv4Tests::test_everflow_dscp_with_policer:
  skip:
    reason: "Test not supported on Mellanox platforms"
    conditions:
      - "asic_type in ['mellanox']"

everflow/test_everflow_testbed.py::TestEverflowV4EgressAclEgressMirror:
  skip:
    reason: "For Mellanox t0-120 setup - Need to skip the test due to HW resource limitation.
             For Cisco-8000 - EverflowV4 EgressAcl EgressMirror - is not yet fully supported on cisco chassis. Skipping it till it is fully validated."
    conditions_logical_operator: "OR"
    conditions:
      - "asic_type in ['cisco-8000']"
      - "'t0-120' in topo_name and asic_type in ['mellanox']"

everflow/test_everflow_testbed.py::TestEverflowV4EgressAclEgressMirror::test_everflow_dscp_with_policer:
  skip:
    reason: "Skipping test since mirror with policer is not supported on Cisco 8000 platforms and Broadcom DNX platforms."
    conditions_logical_operator: "OR"
    conditions:
      - "asic_subtype in ['broadcom-dnx']"
      - "asic_type in ['cisco-8000']"

everflow/test_everflow_testbed.py::TestEverflowV4IngressAclIngressMirror::test_everflow_dscp_with_policer:
  skip:
    reason: "Skipping test since mirror with policer is not supported on Cisco 8000 platforms and Broadcom DNX platforms."
    conditions_logical_operator: "OR"
    conditions:
      - "asic_type in ['cisco-8000']"
      - "asic_subtype in ['broadcom-dnx']"

#######################################
#####            fdb              #####
#######################################
fdb/test_fdb_mac_expire.py:
  skip:
    reason: "Not supported on this DUT topology."
    conditions:
      - "topo_type not in ['t0', 'm0', 'mx']"

#######################################
#####            fib              #####
#######################################
fib/test_fib.py::test_ipinip_hash:
  skip:
    reason: 'ipinip hash test is not fully supported on mellanox platform (case#00581265)'
    conditions:
      - "asic_type in ['mellanox']"

#######################################
#####   generic_config_updater    #####
#######################################
generic_config_updater:
  skip:
    reason: 'generic_config_updater is not a supported feature for T2'
    conditions:
      - "'t2' in topo_name"

generic_config_updater/test_dhcp_relay.py:
  skip:
    reason: "Need to skip for platform x86_64-8111_32eh_o-r0 or backend topology / generic_config_updater is not a supported feature for T2"
    conditions_logical_operator: "OR"
    conditions:
      - "platform in ['x86_64-8111_32eh_o-r0']"
      - "'backend' in topo_name"
      - "'t2' in topo_name"

generic_config_updater/test_dynamic_acl.py:
  skip:
    reason: "Device SKUs do not support the custom ACL_TABLE_TYPE that we use in this test.  Known log error unrelated to test
    on m0-2vlan testbed causes consistent failures / generic_config_updater is not a supported feature for T2"
    conditions_logical_operator: "OR"
    conditions:
      - "release in ['202311', '202405'] and platform in ['armhf-nokia_ixs7215_52x-r0']"
      - "hwsku in ['Cisco-8111-O64']"
      - "topo_name in ['m0-2vlan']"
      - "'t2' in topo_name"

generic_config_updater/test_ecn_config_update.py::test_ecn_config_updates:
  skip:
    reason: "This test is not run on this asic type, topology, or version currently / generic_config_updater is not a supported feature for T2"
    conditions_logical_operator: "OR"
    conditions:
      - "asic_type in ['cisco-8000']"
      - "topo_type in ['m0', 'mx']"
      - "release in ['202211']"
      - "'t2' in topo_name"

generic_config_updater/test_eth_interface.py::test_replace_fec:
  skip:
    reason: 'Skipping test on 7260/3800 platform due to bug of https://github.com/sonic-net/sonic-mgmt/issues/11237
             / generic_config_updater is not a supported feature for T2'
    conditions_logical_operator: "OR"
    conditions:
      - "hwsku in ['Arista-7260CX3-D108C8', 'Arista-7260CX3-Q64', 'Mellanox-SN3800-D112C8'] and 'https://github.com/sonic-net/sonic-mgmt/issues/11237'"
      - "'t2' in topo_name"

generic_config_updater/test_eth_interface.py::test_toggle_pfc_asym:
  skip:
    reason: "Skip asym pfc on unsupported platforms"
    conditions_logical_operator: "OR"
    conditions:
      - "asic_type in ['cisco-8000']"
      - "'t2' in topo_name"

generic_config_updater/test_eth_interface.py::test_update_speed:
  skip:
    reason: 'Skip this script due to this not being a production scenario and misleading StateDB output for valid speed / generic_config_updater is not a supported feature for T2'
    conditions_logical_operator: "OR"
    conditions:
      - https://github.com/sonic-net/sonic-mgmt/issues/8143
      - https://github.com/sonic-net/sonic-buildimage/issues/13267
      - "'t2' in topo_name"

generic_config_updater/test_incremental_qos.py:
  skip:
    reason: "Does not support dualtor right now, due to issue https://github.com/sonic-net/sonic-mgmt/issues/14865
             / generic_config_updater is not a supported feature for T2"
    conditions_logical_operator: "OR"
    conditions:
      - "'dualtor' in topo_name"
      - "'t2' in topo_name"

generic_config_updater/test_incremental_qos.py::test_incremental_qos_config_updates:
  skip:
    reason: "This test is not run on this hwsku/asic type or version or topology currently"
    conditions_logical_operator: "OR"
    conditions:
      - "not any(i in hwsku for i in ['2700', 'Arista-7170-64C', 'montara', 'newport']) and asic_type in ['broadcom', 'cisco-8000'] and release in ['202211']"
      - "'t2' in topo_name"

generic_config_updater/test_mmu_dynamic_threshold_config_update.py::test_dynamic_th_config_updates:
  skip:
    reason: "This test is not run on this asic type or version or topology currently"
    conditions_logical_operator: "OR"
    conditions:
      - "asic_type in ['broadcom', 'cisco-8000'] and release in ['202211']"
      - "'t2' in topo_name"

generic_config_updater/test_pfcwd_status.py:
  skip:
    reason: "This test is not run on this topo type or version or topology currently"
    conditions_logical_operator: "OR"
    conditions:
      - "topo_type in ['m0', 'mx']"
      - "release in ['202211']"
      - "'t2' in topo_name"

generic_config_updater/test_pg_headroom_update.py:
  skip:
    reason: "Unsupported topology."
    conditions_logical_operator: "OR"
    conditions:
      - "topo_type in ['m0', 'mx']"
      - "'t2' in topo_name"

#######################################
#####           hash              #####
#######################################
hash/test_generic_hash.py::test_algorithm_config:
  xfail:
    reason: "This is a new test cases and doesn't work for platform other than Mellanox, xfail them before the issue is addressed"
    conditions:
      - "asic_type not in ['mellanox']"
      - https://github.com/sonic-net/sonic-mgmt/issues/14109

hash/test_generic_hash.py::test_backend_error_messages:
  xfail:
    reason: "This is a new test cases and doesn't work for platform other than Mellanox, xfail them before the issue is addressed"
    conditions:
      - "asic_type not in ['mellanox']"
      - https://github.com/sonic-net/sonic-mgmt/issues/14109

hash/test_generic_hash.py::test_ecmp_and_lag_hash:
  skip:
    reason: 'On Mellanox SPC1 platforms, due to HW limitation, it would not support CRC_CCITT algorithm'
    conditions:
      - "asic_gen == 'spc1'"

hash/test_generic_hash.py::test_ecmp_and_lag_hash[CRC-INNER_IP_PROTOCOL:
  skip:
    reason: "On Mellanox platforms, due to HW limitation, it would not support CRC algorithm on INNER_IP_PROTOCOL field"
    conditions:
    - "asic_type in ['mellanox']"

hash/test_generic_hash.py::test_ecmp_hash[CRC-INNER_IP_PROTOCOL:
  skip:
    reason: "On Mellanox platforms, due to HW limitation, it would not support CRC algorithm on INNER_IP_PROTOCOL field"
    conditions:
    - "asic_type in ['mellanox']"

hash/test_generic_hash.py::test_hash_capability:
  xfail:
    reason: "This is a new test cases and doesn't work for platform other than Mellanox, xfail them before the issue is addressed"
    conditions:
      - "asic_type not in ['mellanox']"
      - https://github.com/sonic-net/sonic-mgmt/issues/14109

hash/test_generic_hash.py::test_lag_hash[CRC-INNER_IP_PROTOCOL:
  skip:
    reason: "On Mellanox platforms, due to HW limitation, it would not support CRC algorithm on INNER_IP_PROTOCOL field"
    conditions:
    - "asic_type in ['mellanox']"

hash/test_generic_hash.py::test_lag_member_flap:
  skip:
    reason: 'On Mellanox SPC1 platforms, due to HW limitation, it would not support CRC_CCITT algorithm, for other platforms, skipping due to missing object in SonicHost'
    conditions_logical_operator: "OR"
    conditions:
      - "asic_gen == 'spc1'"
      - https://github.com/sonic-net/sonic-mgmt/issues/13919

hash/test_generic_hash.py::test_lag_member_flap[CRC-INNER_IP_PROTOCOL:
  skip:
    reason: "On Mellanox platforms, due to HW limitation, it would not support CRC algorithm on INNER_IP_PROTOCOL field"
    conditions:
    - "asic_type in ['mellanox']"

hash/test_generic_hash.py::test_lag_member_remove_add:
  skip:
    reason: 'On Mellanox SPC1 platforms, due to HW limitation, it would not support CRC_CCITT algorithm, for other platforms, skipping due to missing object in SonicHost'
    conditions_logical_operator: "OR"
    conditions:
      - "asic_gen == 'spc1'"
      - https://github.com/sonic-net/sonic-mgmt/issues/13919

hash/test_generic_hash.py::test_lag_member_remove_add[CRC-INNER_IP_PROTOCOL:
  skip:
    reason: "On Mellanox platforms, due to HW limitation, it would not support CRC algorithm on INNER_IP_PROTOCOL field"
    conditions:
    - "asic_type in ['mellanox']"

hash/test_generic_hash.py::test_nexthop_flap:
  skip:
    reason: 'On Mellanox SPC1 platforms, due to HW limitation, it would not support CRC_CCITT algorithm, for other platforms, skipping due to missing object in SonicHost'
    conditions_logical_operator: "OR"
    conditions:
      - "asic_gen == 'spc1'"
      - https://github.com/sonic-net/sonic-mgmt/issues/13919

hash/test_generic_hash.py::test_nexthop_flap[CRC-INNER_IP_PROTOCOL:
  skip:
    reason: "On Mellanox platforms, due to HW limitation, it would not support CRC algorithm on INNER_IP_PROTOCOL field"
    conditions:
    - "asic_type in ['mellanox']"

hash/test_generic_hash.py::test_reboot:
  skip:
    reason: 'On Mellanox SPC1 platforms, due to HW limitation, it would not support CRC_CCITT algorithm'
    conditions:
      - "asic_gen == 'spc1'"

hash/test_generic_hash.py::test_reboot[CRC-INNER_IP_PROTOCOL:
  skip:
    reason: "On Mellanox platforms, due to HW limitation, it would not support CRC algorithm on INNER_IP_PROTOCOL field"
    conditions:
    - "asic_type in ['mellanox']"

#######################################
#####           http              #####
#######################################
http/test_http_copy.py:
  skip:
    reason: "Test doesn't clean up the files in /tmp, it will cause the subsequent cases in /tmp fail, skipping until the issue is addressed"

#######################################
#####    iface_loopback_action    #####
#######################################
iface_loopback_action/test_iface_loopback_action.py:
  skip:
    reason: "Test only supported on Mellanox SKUs, didn't supported on dualtor topology."
    conditions_logical_operator: or
    conditions:
      - "'dualtor' in topo_name"
      - "asic_type not in ['mellanox']"

#######################################
#####      iface_namingmode       #####
#######################################
iface_namingmode/test_iface_namingmode.py::TestConfigInterface:
  skip:
    reason: "x86_64-8111_32eh_o-r0 platform does not support TestConfigInterface"
    conditions:
      - "platform in ['x86_64-8111_32eh_o-r0']"

iface_namingmode/test_iface_namingmode.py::TestShowPriorityGroup:
  xfail:
    reason: "Platform specific issue"
    strict: True
    conditions:
      - "platform in ['x86_64-cel_e1031-r0']"
  skip:
    reason: "M0/MX topo does not support TestShowPriorityGroup"
    conditions:
      - "topo_type in ['m0', 'mx']"

iface_namingmode/test_iface_namingmode.py::TestShowQueue:
  skip:
    reason: "M0/MX topo does not support TestShowQueue"
    conditions:
      - "topo_type in ['m0', 'mx']"

iface_namingmode/test_iface_namingmode.py::TestShowQueue::test_show_queue_persistent_watermark:
  xfail:
    reason: "Platform specific issue"
    strict: True
    conditions:
      - "platform in ['x86_64-cel_e1031-r0']"

iface_namingmode/test_iface_namingmode.py::TestShowQueue::test_show_queue_watermark:
  xfail:
    reason: "Platform specific issue"
    strict: True
    conditions:
      - "platform in ['x86_64-cel_e1031-r0']"

#######################################
#####            ip               #####
#######################################
ip/test_ip_packet.py:
  skip:
    reason: "Skipping ip packet test since can't provide enough interfaces"
    conditions:
      - "len(minigraph_interfaces) < 2 and len(minigraph_portchannels) < 2"

ip/test_ip_packet.py::TestIPPacket::test_forward_ip_packet_with_0xffff_chksum_drop:
  skip:
    reason: "Broadcom, Cisco, Barefoot, Innovium and Marvell Asic will tolorate IP packets with 0xffff checksum
            / Skipping ip packet test since can't provide enough interfaces"
    conditions_logical_operator: or
    conditions:
      - "asic_type in ['broadcom', 'cisco-8000', 'marvell', 'barefoot', 'innovium'] and asic_subtype not in ['broadcom-dnx']"
      - "len(minigraph_interfaces) < 2 and len(minigraph_portchannels) < 2"

ip/test_ip_packet.py::TestIPPacket::test_forward_ip_packet_with_0xffff_chksum_tolerant:
  skip:
    reason: "Mellanox and Broadcom DNX Asic will drop IP packets with 0xffff checksum
            / Skipping ip packet test since can't provide enough interfaces"
    conditions_logical_operator: or
    conditions:
      - "asic_type in ['mellanox'] or asic_subtype in ['broadcom-dnx']"
      - "len(minigraph_interfaces) < 2 and len(minigraph_portchannels) < 2"

ip/test_mgmt_ipv6_only.py:
  skip:
    reason: "Skipping mgmt ipv6 test for mgmt topo"
    conditions:
      - "topo_type in ['m0', 'mx']"

#######################################
#####            ipfwd            #####
#######################################
ipfwd/test_dip_sip.py:
  skip:
    reason: "Unsupported topology."
    conditions:
      - "topo_type not in ['t0', 't1', 't2', 'm0', 'mx']"

ipfwd/test_dir_bcast.py:
  skip:
    reason: "Unsupported topology."
    conditions:
      - "topo_type not in ['t0', 'm0', 'mx'] or 'dualtor' in topo_name or 't0-backend' in topo_name"

ipfwd/test_mtu.py:
  skip:
    reason: "Unsupported topology."
    conditions:
      - "topo_type not in ['t1', 't2']"

#######################################
#######         link_flap         #####
#######################################
link_flap/test_cont_link_flap.py:
  xfail:
    reason: "system could be not reaching stable status while BGP converged"
    conditions:
      - https://github.com/sonic-net/sonic-mgmt/issues/10955

#######################################
#####           lldp              #####
#######################################
lldp/test_lldp.py::test_lldp:
  skip:
    reason: "Skipping LLDP test because the topology is standalone. No LLDP neighbors detected."
    conditions:
      - "'standalone' in topo_name"

lldp/test_lldp.py::test_lldp_neighbor:
  skip:
    reason: "Skipping LLDP test because the topology is standalone. No LLDP neighbors detected."
    conditions:
      - "'standalone' in topo_name"

#######################################
#####           macsec            #####
#######################################
macsec/test_dataplane.py::TestDataPlane::test_server_to_neighbor:
  skip:
    reason: 'test_server_to_neighbor needs downstream neighbors, which is not present in this topo'
    conditions:
      - "'t2' in topo_name"

macsec/test_interop_protocol.py::TestInteropProtocol::test_bgp:
  skip:
    reason: 'test_bgp skip in Brcm based T2, complete portchannel SAI fix planned for 8.1'
    conditions:
      - "asic_subtype in ['broadcom-dnx']"

macsec/test_macsec.py:
  skip:
    reason: "This test can only run on 7280 CR3"
    conditions:
      - "platform not in ['x86_64-arista_7280cr3mk_32d4', 'x86_64-kvm_x86_64-r0']"

#######################################
#####            mpls             #####
#######################################
mpls/test_mpls.py:
  skip:
    reason: "MPLS TCs are not supported on Barefoot plarforms"
    conditions:
      - "asic_type in ['barefoot']"

#######################################
#####           mvrf              #####
#######################################
mvrf:
  skip:
    reason: "M0/MX topo does not support mvrf"
    conditions:
      - "topo_type in ['m0', 'mx']"

#######################################
#####           nat               #####
#######################################
nat:
  skip:
    reason: "Nat feature is not enabled with image version"
    conditions:
      - "'nat' not in feature_status"

#######################################
#####    override_config_table    #####
#######################################
override_config_table/test_override_config_table.py:
  skip:
    reason: "Skip on multi-asic platforms as test provided golden config format is not compatible with multi-asics."
    conditions:
      - "is_multi_asic==True"

#######################################
#####           pc               #####
#######################################
pc/test_lag_2.py::test_lag_db_status_with_po_update:
  skip:
    reason: "Only support t1-lag, t1-56-lag, t1-64-lag and t2 topology"
    conditions:
        - "topo_name not in ['t1-lag', 't1-56-lag', 't1-64-lag'] and 't2' not in topo_name"

pc/test_lag_member.py:
  skip:
    reason: "Not support dualtor or t0 backend topo / Have an issue on kvm t0"
    conditions_logical_operator: or
    conditions:
        - "'dualtor' in topo_name or 't0-backend' in topo_name"
        - "asic_type in ['vs'] and https://github.com/sonic-net/sonic-mgmt/issues/13898"

pc/test_po_cleanup.py:
  skip:
    reason: "Skip test due to there is no portchannel exists in current topology."
    conditions:
      - "len(minigraph_portchannels) == 0 and not is_multi_asic"

pc/test_po_update.py::test_po_update:
  skip:
    reason: "Skip test due to there is no portchannel or no portchannel member exists in current topology."
    conditions:
      - "len(minigraph_portchannels) == 0 or len(minigraph_portchannels[list(minigraph_portchannels.keys())[0]]['members']) == 0"

pc/test_po_update.py::test_po_update_io_no_loss:
  skip:
    reason: "Skip test due to there isn't enough port channel exists in current topology."
    conditions:
      - "len(minigraph_portchannel_interfaces) < 2"

pc/test_po_voq.py:
  skip:
    reason: "Skip for non t2 or Skip since there is no portchannel configured or no portchannel member exists in current topology."
    conditions:
      - "'t2' not in topo_name or num_asic == 0 or len(minigraph_portchannels[list(minigraph_portchannels.keys())[0]]['members']) == 0 or asic_type in ['cisco-8000']"

#######################################
#####           pfc               #####
#######################################
pfc/test_unknown_mac.py:
  skip:
    reason: In cisco-8000 platform, a packet with unknown MAC will be flooded, not dropped. This case will not pass in cisco-8000.
    conditions:
      - "asic_type in ['cisco-8000']"

#######################################
#####         pfc_asym            #####
#######################################
pfc_asym/test_pfc_asym.py:
  skip:
    reason: 'pfc_asym test skip except for on Barefoot platforms'
    conditions:
      - "asic_type not in ['barefoot']"

pfc_asym/test_pfc_asym.py::test_pfc_asym_off_rx_pause_frames:
   skip:
     reason: "skipped for Barefoot platform"
     conditions:
        - "asic_type in ['barefoot']"

#######################################
#####         pfcwd               #####
#######################################
pfcwd:
  skip:
    reason: "Pfcwd tests skipped on m0/mx testbed."
    conditions:
      - "topo_type in ['m0', 'mx']"

pfcwd/test_pfc_config.py::TestPfcConfig::test_forward_action_cfg:
   skip:
     reason: "Forward action not supported in cisco-8000/m0/mx"
     conditions_logical_operator: or
     conditions:
        - "asic_type in ['cisco-8000']"
        - "topo_type in ['m0', 'mx']"

pfcwd/test_pfcwd_all_port_storm.py:
   skip:
     reason: "Slow pfc generation rate on 7060x6 200Gb,
              pfc generation function on the Arista fanout device need to be improved by Arista
              / Pfcwd tests skipped on m0/mx testbed."
     conditions_logical_operator: or
     conditions:
      - "hwsku in ['Arista-7060X6-64PE-256x200G']"
      - "topo_type in ['m0', 'mx']"

pfcwd/test_pfcwd_function.py::TestPfcwdFunc::test_pfcwd_no_traffic:
   skip:
     reason: "This test is applicable only for cisco-8000 / Pfcwd tests skipped on m0/mx testbed."
     conditions_logical_operator: or
     conditions:
        - "asic_type != 'cisco-8000'"
        - "topo_type in ['m0', 'mx']"

pfcwd/test_pfcwd_warm_reboot.py:
   skip:
     reason: "Warm Reboot is not supported in T2 or in standalone topos. / Pfcwd tests skipped on m0/mx testbed."
     conditions_logical_operator: or
     conditions:
        - "'t2' in topo_name"
        - "'standalone' in topo_name"
        - "topo_type in ['m0', 'mx']"
   xfail:
     reason: "Warm Reboot is not supported in dualtor and has a known issue on 202305 branch"
     conditions:
        - "'dualtor' in topo_name"
        - https://github.com/sonic-net/sonic-mgmt/issues/8400

#######################################
#####     process_monitoring      #####
#######################################
process_monitoring/test_critical_process_monitoring.py::test_orchagent_heartbeat:
  skip:
    reason: This test is intended for Orchagent freeze scenario during warm-reboot. It is not required for T1 devices.
    conditions:
      - "'t1' in topo_name"

#######################################
#####           qos               #####
#######################################
qos:
  skip:
    reason: "M0/MX topo does not support qos"
    conditions:
      - "topo_type in ['m0', 'mx']"

qos/test_buffer.py:
  skip:
    reason: "These tests don't apply to cisco 8000 platforms or T2 or m0/mx, since they support only traditional model."
    conditions_logical_operator: or
    conditions:
      - "asic_type in ['cisco-8000'] or 't2' in topo_name"
      - "topo_type in ['m0', 'mx']"

qos/test_buffer.py::test_buffer_model_test:
  skip:
    reason: "Running only on mellanox devices and covered by unit testing / M0/MX topo does not support qos"
    conditions_logical_operator: or
    conditions:
      - "asic_type in ['mellanox']"
      - "topo_type in ['m0', 'mx']"

qos/test_buffer_traditional.py:
  skip:
    reason: "Buffer traditional test is only supported 201911 branch / M0/MX topo does not support qos"
    conditions_logical_operator: or
    conditions:
      - "release not in ['201911']"
      - "topo_type in ['m0', 'mx']"

qos/test_pfc_pause.py::test_pfc_pause_lossless:
  # For this test, we use the fanout connected to the DUT to send PFC pause frames.
  # The fanout needs to send PFC frames fast enough so that the queue remains completely paused for the entire duration
  # of the test. The inter packet interval between PFC frames to completely block a queue vary based on link speed and
  # we have seen flakiness in our test runs. Since this test is already covered under the 'ixia' folder where we use a
  # traffic generator to generate pause frames, skipping this here.
  skip:
    reason: "Fanout needs to send PFC frames fast enough to completely pause the queue"

qos/test_qos_dscp_mapping.py::TestQoSSaiDSCPQueueMapping_IPIP_Base::test_dscp_to_queue_mapping_pipe_mode:
  skip:
    reason: "Pipe decap mode not supported due to either SAI or platform limitation / M0/MX topo does not support qos"
    conditions_logical_operator: or
    conditions:
      - "asic_type in ['mellanox', 'broadcom', 'cisco-8000']"
      - https://github.com/sonic-net/sonic-mgmt/issues/12906
      - "topo_type in ['m0', 'mx']"

qos/test_qos_masic.py:
  skip:
    reason: "QoS tests for multi-ASIC only. Supported topos: t1-lag, t1-64-lag, t1-56-lag, t1-backend. / M0/MX topo does not support qos"
    conditions_logical_operator: or
    conditions:
      - "is_multi_asic==False or topo_name not in ['t1-lag', 't1-64-lag', 't1-56-lag', 't1-backend']"
      - "topo_type in ['m0', 'mx']"

qos/test_qos_sai.py:
  skip:
    reason: "qos_sai tests not supported on t1 topo / M0/MX topo does not support qos"
    conditions_logical_operator: or
    conditions:
      - "asic_type in ['barefoot'] and topo_name in ['t1']"
      - "topo_type in ['m0', 'mx']"

qos/test_qos_sai.py::TestQosSai:
  skip:
    reason: "Unsupported testbed type. / M0/MX topo does not support qos"
    conditions_logical_operator: or
    conditions:
      - "topo_name not in ['t0', 't0-64', 't0-116', 't0-35', 't0-56', 't0-standalone-32', 't0-standalone-64', 't0-standalone-128', 't0-standalone-256', 'dualtor-56', 'dualtor-120', 'dualtor', 't0-80', 't0-backend', 't1-lag', 't1-64-lag', 't1-56-lag', 't1-backend', 't2', 't2_2lc_36p-masic', 't2_2lc_min_ports-masic'] and asic_type not in ['mellanox']"
      - "topo_type in ['m0', 'mx']"

qos/test_qos_sai.py::TestQosSai::testIPIPQosSaiDscpToPgMapping:
  skip:
    reason: "For DSCP to PG mapping on IPinIP traffic , mellanox device has different behavior to community. For mellanox device, testQosSaiDscpToPgMapping can cover the scenarios / M0/MX topo does not support qos"
    conditions_logical_operator: or
    conditions:
      - "asic_type in ['mellanox']"
      - https://github.com/sonic-net/sonic-mgmt/issues/12906
      - "topo_type in ['m0', 'mx']"

qos/test_qos_sai.py::TestQosSai::testPfcStormWithSharedHeadroomOccupancy:
  skip:
    reason: "This test is only for Mellanox. / M0/MX topo does not support qos"
    conditions_logical_operator: or
    conditions:
      - "asic_type in ['cisco-8000']"
      - "topo_type in ['m0', 'mx']"

qos/test_qos_sai.py::TestQosSai::testQosSaiBufferPoolWatermark:
  skip:
    reason: "sai_thrift_read_buffer_pool_watermark are not supported on DNX / M0/MX topo does not support qos"
    conditions_logical_operator: or
    conditions:
      - "platform in ['x86_64-nokia_ixr7250e_36x400g-r0', 'x86_64-arista_7800r3_48cq2_lc', 'x86_64-arista_7800r3_48cqm2_lc', 'x86_64-arista_7800r3a_36d2_lc', 'x86_64-arista_7800r3a_36dm2_lc','x86_64-arista_7800r3ak_36dm2_lc']"
      - "topo_type in ['m0', 'mx']"

qos/test_qos_sai.py::TestQosSai::testQosSaiDot1pPgMapping:
  skip:
    reason: "Dot1p-PG mapping is only supported on backend. / M0/MX topo does not support qos"
    conditions_logical_operator: or
    conditions:
      - "'backend' not in topo_name"
      - "topo_type in ['m0', 'mx']"

qos/test_qos_sai.py::TestQosSai::testQosSaiDot1pQueueMapping:
  skip:
    reason: "Dot1p-queue mapping is only supported on backend. / M0/MX topo does not support qos"
    conditions_logical_operator: or
    conditions:
      - "'backend' not in topo_name"
      - "topo_type in ['m0', 'mx']"

qos/test_qos_sai.py::TestQosSai::testQosSaiDscpQueueMapping:
  skip:
    reason: "Dscp-queue mapping is not supported on backend. / M0/MX topo does not support qos"
    conditions_logical_operator: or
    conditions:
      - "'backend' in topo_name"
      - "topo_type in ['m0', 'mx']"

qos/test_qos_sai.py::TestQosSai::testQosSaiDscpToPgMapping:
  skip:
    reason: "Dscp-PG mapping is not supported on backend. / M0/MX topo does not support qos"
    conditions_logical_operator: or
    conditions:
      - "'backend' in topo_name"
      - "topo_type in ['m0', 'mx']"

qos/test_qos_sai.py::TestQosSai::testQosSaiDwrrWeightChange:
  skip:
    reason: "Skip DWRR weight change test on Mellanox platform. / M0/MX topo does not support qos"
    conditions_logical_operator: or
    conditions:
      - "asic_type in ['mellanox']"
      - "topo_type in ['m0', 'mx']"

qos/test_qos_sai.py::TestQosSai::testQosSaiFullMeshTrafficSanity:
  skip:
    reason: "Unsupported platform or testbed type. / M0/MX topo does not support qos"
    conditions_logical_operator: or
    conditions:
      - "asic_type not in ['cisco-8000'] or topo_name not in ['ptf64']"
      - "topo_type in ['m0', 'mx']"

qos/test_qos_sai.py::TestQosSai::testQosSaiHeadroomPoolSize:
  skip:
    reason: "Headroom pool size not supported. / M0/MX topo does not support qos"
    conditions_logical_operator: or
    conditions:
      - "https://github.com/sonic-net/sonic-mgmt/issues/12292 and hwsku in ['Force10-S6100']
      and topo_type in ['t1-64-lag'] and hwsku not in ['Arista-7060CX-32S-C32', 'Celestica-DX010-C32', 'Arista-7260CX3-D108C8', 'Force10-S6100', 'Arista-7260CX3-Q64', 'Arista-7050CX3-32S-C32', 'Arista-7050CX3-32S-D48C8', 'Arista-7060CX-32S-D48C8'] and asic_type not in ['mellanox']
      and asic_type in ['cisco-8000']"
      - "topo_type in ['m0', 'mx']"

qos/test_qos_sai.py::TestQosSai::testQosSaiHeadroomPoolWatermark:
  skip:
    reason: "sai_thrift_read_buffer_pool_watermark are not supported on DNX / M0/MX topo does not support qos"
    conditions_logical_operator: or
    conditions:
      - "platform in ['x86_64-nokia_ixr7250e_36x400g-r0', 'x86_64-arista_7800r3_48cq2_lc', 'x86_64-arista_7800r3_48cqm2_lc', 'x86_64-arista_7800r3a_36d2_lc', 'x86_64-arista_7800r3a_36dm2_lc', 'x86_64-arista_7800r3ak_36dm2_lc'] or asic_type in ['mellanox']
         and asic_type in ['cisco-8000']
         and https://github.com/sonic-net/sonic-mgmt/issues/12292 and hwsku in ['Force10-S6100'] and topo_type in ['t1-64-lag']"
      - "topo_type in ['m0', 'mx']"
  xfail:
    reason: "Headroom pool size not supported."
    conditions:
      - "hwsku not in ['Arista-7060CX-32S-C32', 'Celestica-DX010-C32', 'Arista-7260CX3-D108C8', 'Force10-S6100', 'Arista-7260CX3-Q64', 'Arista-7050CX3-32S-C32', 'Arista-7050CX3-32S-D48C8']"

qos/test_qos_sai.py::TestQosSai::testQosSaiLosslessVoq:
  skip:
    reason: "Lossless Voq test is not supported / M0/MX topo does not support qos"
    conditions_logical_operator: or
    conditions:
      - "asic_type not in ['cisco-8000'] or platform in ['x86_64-8122_64eh_o-r0']"
      - "topo_type in ['m0', 'mx']"

qos/test_qos_sai.py::TestQosSai::testQosSaiLossyQueueVoq:
  skip:
    reason: "Lossy Queue Voq test is not supported / M0/MX topo does not support qos"
    conditions_logical_operator: or
    conditions:
      - "asic_type not in ['cisco-8000'] or platform in ['x86_64-8122_64eh_o-r0']"
      - "topo_type in ['m0', 'mx']"

qos/test_qos_sai.py::TestQosSai::testQosSaiLossyQueueVoqMultiSrc:
  skip:
    reason: "Lossy Queue Voq multiple source test is not supported / M0/MX topo does not support qos"
    conditions_logical_operator: or
    conditions:
      - "asic_type not in ['cisco-8000']"
      - "topo_type in ['m0', 'mx']"

qos/test_qos_sai.py::TestQosSai::testQosSaiPGDrop:
  skip:
    reason: "PG drop size test is not supported. / M0/MX topo does not support qos"
    conditions_logical_operator: or
    conditions:
      - "asic_type not in ['cisco-8000'] or platform in ['x86_64-8122_64eh_o-r0']"
      - "topo_type in ['m0', 'mx']"

qos/test_qos_sai.py::TestQosSai::testQosSaiPgHeadroomWatermark:
  skip:
    reason: "Priority Group Headroom Watermark is not supported on cisco asic. PG drop counter stat is covered as a part of testQosSaiPfcXoffLimit
            / M0/MX topo does not support qos"
    conditions_logical_operator: or
    conditions:
      - "asic_type in ['cisco-8000'] and platform not in ['x86_64-8122_64eh_o-r0']"
      - "topo_type in ['m0', 'mx']"

qos/test_qos_sai.py::TestQosSai::testQosSaiPgSharedWatermark[None-wm_pg_shared_lossy]:
  xfail:
    reason: "Image issue on Arista platforms"
    conditions:
      - "platform in ['x86_64-arista_7050cx3_32s']"

qos/test_qos_sai.py::TestQosSai::testQosSaiQWatermarkAllPorts:
  skip:
    reason: "All Port Watermark test is verified only on Cisco Platforms. / M0/MX topo does not support qos"
    conditions_logical_operator: or
    conditions:
      - "asic_type not in ['cisco-8000']"
      - "topo_type in ['m0', 'mx']"

qos/test_qos_sai.py::TestQosSai::testQosSaiSharedReservationSize:
  skip:
    reason: "Shared reservation size test is not supported. / M0/MX topo does not support qos"
    conditions_logical_operator: or
    conditions:
      - "asic_type not in ['cisco-8000'] or platform in ['x86_64-8122_64eh_o-r0']"
      - "topo_type in ['m0', 'mx']"

qos/test_tunnel_qos_remap.py::test_pfc_watermark_extra_lossless_active:
  xfail:
    reason: "test_pfc_watermark_extra_lossless_active is not support on broadcom platform yet"
    conditions:
      - "asic_type in ['broadcom']"
      - https://github.com/sonic-net/sonic-mgmt/issues/11271

qos/test_tunnel_qos_remap.py::test_pfc_watermark_extra_lossless_standby:
  xfail:
    reason: "test_pfc_watermark_extra_lossless_standby is not support on broadcom platform yet"
    conditions:
      - "asic_type in ['broadcom']"
      - https://github.com/sonic-net/sonic-mgmt/issues/11271

#######################################
#####           radv             #####
#######################################
radv/test_radv_ipv6_ra.py::test_solicited_router_advertisement_with_m_flag:
  skip:
    reason: "Test case has issue on the dualtor-64 topo."
    conditions:
      - "https://github.com/sonic-net/sonic-mgmt/issues/11322 and 'dualtor-64' in topo_name"

radv/test_radv_ipv6_ra.py::test_unsolicited_router_advertisement_with_m_flag:
  skip:
    reason: "Test case has issue on the dualtor-64 topo."
    conditions:
      - "https://github.com/sonic-net/sonic-mgmt/issues/11322 and 'dualtor-64' in topo_name"

#######################################
#####      reset_factory          #####
#######################################
reset_factory/test_reset_factory.py:
  skip:
    reason: "This case has a known issue which leaves the DUT in a bad state. Skipping until the issue is addressed."
    conditions:
      - https://github.com/sonic-net/sonic-mgmt/issues/11103

#######################################
#####         restapi             #####
#######################################
restapi/test_restapi.py:
  skip:
    reason: "Only supported on Mellanox"
    conditions:
      - "asic_type not in ['mellanox']"

restapi/test_restapi.py::test_create_vrf:
  skip:
    reason: "Only supported on Mellanox T1"
    conditions_logical_operator: or
    conditions:
      - "'t1' not in topo_type"
      - "asic_type not in ['mellanox']"

restapi/test_restapi_vxlan_ecmp.py:
  skip:
    reason: "Only supported on cisco 8102, 8101 and mlnx 4600C T1"
    conditions:
      - "not (platform in ['x86_64-8102_64h_o-r0', 'x86_64-8101_32fh_o-r0', 'x86_64-mlnx_msn4600c-r0']  and 't1' in topo_type)"

#######################################
#####           route             #####
#######################################
route/test_default_route.py:
  skip:
    reason: "Does not apply to standalone topos."
    conditions:
      - "'standalone' in topo_name"

route/test_route_flap.py:
  skip:
    reason: "Test case has issue on the t0-56-povlan and dualtor-64 topo. Does not apply to standalone topos."
    conditions_logical_operator: or
    conditions:
      - "https://github.com/sonic-net/sonic-mgmt/issues/11323 and 't0-56-po2vlan' in topo_name"
      - "https://github.com/sonic-net/sonic-mgmt/issues/11324 and 'dualtor-64' in topo_name"
      - "'standalone' in topo_name"

route/test_route_perf.py:
  skip:
    reason: "Does not apply to standalone topos."
    conditions:
      - "'standalone' in topo_name"

route/test_static_route.py:
  skip:
    reason: "Test not supported for 201911 images or older. Does not apply to standalone topos."
    conditions_logical_operator: OR
    conditions:
      - "release in ['201811', '201911']"
      - "'standalone' in topo_name"

route/test_static_route.py::test_static_route_ecmp_ipv6:
  # This test case may fail due to a known issue https://github.com/sonic-net/sonic-buildimage/issues/4930.
  # Temporarily disabling the test case due to the this issue.
  skip:
    reason: "Test case may fail due to a known issue / Test not supported for 201911 images or older. Does not apply to standalone topos."
    conditions_logical_operator: OR
    conditions:
      - "https://github.com/sonic-net/sonic-buildimage/issues/4930"
      - "release in ['201811', '201911']"
      - "'standalone' in topo_name"

#######################################
#####      show_techsupport       #####
#######################################
show_techsupport/test_auto_techsupport.py:
  skip:
    reason: "auto techsupport on multi asic platforms doesnt work"
    strict: True
    conditions:
      - (is_multi_asic==True)

show_techsupport/test_auto_techsupport.py::TestAutoTechSupport::test_max_limit[core]:
  xfail:
    reason: "This test case may fail due to a known issue https://github.com/sonic-net/sonic-buildimage/issues/15051."
    conditions:
      - https://github.com/sonic-net/sonic-buildimage/issues/15051

show_techsupport/test_auto_techsupport.py::TestAutoTechSupport::test_sai_sdk_dump:
  skip:
    reason: "Test supported only on Nvidia(Mellanox) devices / auto techsupport on multi asic platforms doesnt work"
    conditions_logical_operator: or
    conditions:
      - "asic_type not in ['mellanox']"
      - "is_multi_asic==True"

#######################################
#####         snappi_tests        #####
#######################################
snappi_tests/ecn/test_red_accuracy_with_snappi:
  skip:
    reason: "Test should not be run as part of nightly."
    conditions:
      - "topo_type in ['tgen']"

snappi_tests/multidut/pfc/test_multidut_global_pause_with_snappi.py:
  skip:
    reason: "Global pause is not supported in cisco-8000."
    conditions:
      - "asic_type in ['cisco-8000']"

#######################################
#####            snmp             #####
#######################################
snmp/test_snmp_default_route.py::test_snmp_default_route:
  skip:
    reason: "Skipping SNMP test because standalone topology has no default routes."
    conditions:
      - "'standalone' in topo_name"

snmp/test_snmp_link_local.py:
  skip:
    reason: "SNMP over IPv6 support not present in release branches."
    conditions:
      - "is_multi_asic==False"
      - "release in ['202205', '202211', '202305', '202311']"
  xfail:
    reason: "Test script has issues on kvm testbed."
    condition:
      - "asic_type in ['vs']"
      - "https://github.com/sonic-net/sonic-mgmt/issues/15081"

snmp/test_snmp_loopback.py::test_snmp_loopback:
  skip:
    reason: "1. Not supported topology backend.
             2. Skipping SNMP test because standalone topology has no neighbor VMs,
            and SNMP queries will be executed from the neighbor VM."
    conditions_logical_operator: OR
    conditions:
      - "'backend' in topo_name"
      - "'standalone' in topo_name"

snmp/test_snmp_pfc_counters.py:
  skip:
    reason: "M0/MX topo does not support test_snmp_pfc_counters"
    conditions:
      - "topo_type in ['m0', 'mx']"

snmp/test_snmp_queue.py:
  skip:
    reason: "Interfaces not present on supervisor node or M0/MX topo does not support test_snmp_queue or unsupported platform"
    conditions:
      - "topo_type in ['m0', 'mx'] or asic_type in ['barefoot']"

snmp/test_snmp_queue_counters.py:
  skip:
    reason: "Have an known issue on kvm testbed"
    conditions:
      - asic_type in ['vs']
      - https://github.com/sonic-net/sonic-mgmt/issues/14007

#######################################
#####            span             #####
#######################################
span:
  skip:
    reason: "Skipping span test on broadcom/cisco-8000 platform."
    conditions:
      - "asic_type in ['broadcom', 'cisco-8000']"

span/test_port_mirroring.py:
  xfail:
    reason: "Testcase ignored on dualtor topology and mellanox setups due to Github issue: https://github.com/sonic-net/sonic-mgmt/issues/9647"
    conditions:
      - "https://github.com/sonic-net/sonic-mgmt/issues/9647 and 'dualtor' in topo_name and asic_type in ['mellanox']"

#######################################
#####             ssh             #####
#######################################
ssh/test_ssh_default_password:
  skip:
    reason: "Skip because the default password test is no longer appropriate after password rotation."

ssh/test_ssh_stress.py::test_ssh_stress:
  # This test is not stable, skip it for now.
  # known issue: https://github.com/paramiko/paramiko/issues/1508
  skip:
    reason: "This test failed intermittent due to known issue of paramiko, skip for now"
    conditions: https://github.com/paramiko/paramiko/issues/1508

#######################################
#####     sub_port_interfaces     #####
#######################################
sub_port_interfaces:
  skip:
    reason: "Unsupported platform or asic"
    conditions:
      - "is_multi_asic==True or asic_gen not in ['td2', 'spc1', 'spc2', 'spc3', 'spc4'] and asic_type not in ['barefoot','innovium']"

sub_port_interfaces/test_show_subinterface.py::test_subinterface_status[port]:
  skip:
    reason: "Unsupported platform or asic"
    conditions_logical_operator: or
    conditions:
      - "asic_type in ['vs'] and https://github.com/sonic-net/sonic-buildimage/issues/19735"
      - "is_multi_asic==True or asic_gen not in ['td2', 'spc1', 'spc2', 'spc3', 'spc4'] and asic_type not in ['barefoot','innovium']"

sub_port_interfaces/test_show_subinterface.py::test_subinterface_status[port_in_lag]:
  skip:
    reason: "Not supported port type"

sub_port_interfaces/test_sub_port_interfaces.py::TestSubPorts::test_routing_between_sub_ports_unaffected_by_sub_ports_removal[port_in_lag:
  skip:
    reason: "Not supported port type"

sub_port_interfaces/test_sub_port_interfaces.py::TestSubPorts::test_tunneling_between_sub_ports:
  skip:
    reason: "Cisco 8000 platform does not support DSCP PIPE Mode for IPinIP Tunnels / Unsupported platform or asic"
    conditions_logical_operator: or
    conditions:
      - "asic_type=='cisco-8000'"
      - "is_multi_asic==True or asic_gen not in ['td2', 'spc1', 'spc2', 'spc3', 'spc4'] and asic_type not in ['barefoot','innovium']"

sub_port_interfaces/test_sub_port_interfaces.py::TestSubPorts::test_untagged_packet_not_routed[port_in_lag] :
  skip:
    reason: "Not supported port type"

sub_port_interfaces/test_sub_port_l2_forwarding.py::test_sub_port_l2_forwarding[port_in_lag]:
  skip:
    reason: "Not supported port type"

#######################################
#####             syslog          #####
#######################################
syslog/test_syslog.py:
  xfail:
    reason: "Generic internal image issue"
    conditions:
      - "branch in ['internal-202012']"
      - "build_version.split('.')[1].isdigit() and int(build_version.split('.')[1]) <= 33"

syslog/test_syslog_source_ip.py:
  skip:
    reason: "Vs setup doesn't work when creating mgmt vrf"
    conditions:
      - "asic_type in ['vs']"

syslog/test_syslog_source_ip.py::TestSSIP::test_syslog_config_work_after_reboot:
  skip:
    reason: "Testcase consistent failed, raised issue to track / Vs setup doesn't work when creating mgmt vrf"
    conditions_logical_operator: or
    conditions:
      - "https://github.com/sonic-net/sonic-buildimage/issues/19638"
      - "asic_type in ['vs']"

syslog/test_syslog_source_ip.py::TestSSIP::test_syslog_protocol_filter_severity:
  skip:
    reason: "Testcase consistent failed, raised issue to track / Vs setup doesn't work when creating mgmt vrf"
    conditions_logical_operator: or
    conditions:
      - "https://github.com/sonic-net/sonic-mgmt/issues/14493"
      - "asic_type in ['vs']"

#######################################
#####         system_health       #####
#######################################
system_health/test_system_health.py::test_service_checker_with_process_exit:
  xfail:
    strict: True
    conditions:
      - "branch in ['internal-202012']"
      - "build_version.split('.')[1].isdigit() and int(build_version.split('.')[1]) <= 44"

#######################################
#####           tacacs          #####
#######################################
tacacs/test_authorization.py::test_authorization_tacacs_and_local:
  skip:
    reason: "Testcase ignored due to Github issue: https://github.com/sonic-net/sonic-mgmt/issues/11349"
    conditions:
      - https://github.com/sonic-net/sonic-mgmt/issues/11349

#######################################
#####           telemetry         #####
#######################################
telemetry/test_events.py:
  skip:
    reason: "Skip telemetry test events for 202211 and older branches"
    conditions:
      - "release in ['201811', '201911', '202012', '202205', '202211']"
  xfail:
    reason: "Test events is flaky in PR test, xfail until issue resolved"
    conditions:
      - "asic_type in ['vs']"
      - https://github.com/sonic-net/sonic-buildimage/issues/19943

telemetry/test_telemetry.py:
  skip:
    reason: "Skip telemetry test for 201911 and older branches"
    conditions:
      - "(is_multi_asic==True) and (release in ['201811', '201911'])"

telemetry/test_telemetry.py::test_telemetry_queue_buffer_cnt:
  skip:
    reason: "Testcase ignored due to switch type is voq"
    conditions:
      - "(switch_type=='voq')"

#######################################
#####         pktgen              #####
#######################################
test_pktgen.py:
  skip:
    reason: "Have known issue, only running for 'cisco-8000', skipping for all other ASIC types"
    conditions:
      - "asic_type not in ['cisco-8000']"
      - "https://github.com/sonic-net/sonic-mgmt/issues/13804"

#######################################
#####         vs_chassis          #####
#######################################
test_vs_chassis_setup.py:
  skip:
    reason: "Skip vs_chassis setup on non-vs testbeds"
    conditions:
      - "asic_type not in ['vs']"

#######################################
#####            vlan             #####
#######################################
vlan/test_vlan.py::test_vlan_tc7_tagged_qinq_switch_on_outer_tag:
  skip:
    reason: "Unsupported platform."
    conditions:
      - "asic_type not in ['mellanox', 'barefoot', 'cisco-8000']"

vlan/test_vlan_ping.py:
  skip:
    reason: "test_vlan_ping doesn't work on Broadcom platform. Ignored on dualtor topo and mellanox setups due to Github issue: https://github.com/sonic-net/sonic-mgmt/issues/9642."
    conditions_logical_operator: OR
    conditions:
      - "asic_type in ['broadcom']"

#######################################
#####             voq             #####
#######################################
voq:
  skip:
    reason: "Cisco 8800 doesn't support voq tests"
    conditions:
      - "asic_type in ['cisco-8000']"

voq/test_fabric_cli_and_db.py:
  skip:
    reason: "Skip test_fabric_cli_and_db on unsupported testbed."
    conditions:
      - "('t2' not in topo_name) or (asic_subtype not in ['broadcom-dnx']) or ('arista_7800' not in platform) or (asic_type in ['cisco-8000'])"

voq/test_fabric_reach.py:
  skip:
    reason: "Skip test_fabric_reach on unsupported testbed."
    conditions:
      - "('t2' not in topo_name) or (asic_subtype not in ['broadcom-dnx']) or ('arista_7800' not in platform) or (asic_type in ['cisco-8000'])"

voq/test_voq_fabric_isolation.py:
  skip:
    reason: "Skip test_voq_fabric_isolation on unsupported testbed."
    conditions:
      - "('t2' not in topo_name) or (asic_subtype not in ['broadcom-dnx']) or (asic_type in ['cisco-8000'])"

voq/test_voq_fabric_status_all.py:
  skip:
    reason: "Skip test_voq_fabric_status_all on unsupported testbed."
    conditions:
      - "('t2' not in topo_name) or (asic_subtype not in ['broadcom-dnx']) or ('arista_7800' not in platform) or (asic_type in ['cisco-8000'])"

#######################################
#####             vrf             #####
#######################################
vrf/test_vrf.py::TestVrfAclRedirect:
  skip:
    reason: "Switch does not support ACL REDIRECT_ACTION."
    conditions:
      - "len([capabilities for capabilities in switch.values() if 'REDIRECT_ACTION' in capabilities]) == 0"

#######################################
#####           vrf_attr          #####
#######################################
vrf/test_vrf_attr.py::TestVrfAttrSrcMac::test_vrf1_neigh_with_default_router_mac:
  skip:
    reason: "RIF MAC taking precedence over VRF MAC"
    conditions:
      - "asic_type in ['barefoot']"

#######################################
#####           vxlan            #####
#######################################
vxlan/test_vnet_route_leak.py:
  skip:
    reason: "Test skipped due to issue #8374"
    conditions:
      - https://github.com/sonic-net/sonic-mgmt/issues/8374

vxlan/test_vnet_vxlan.py:
  skip:
    reason: "1. Enable tests only for: mellanox, barefoot
             2. Test skipped due to issue #8374"
    conditions_logical_operator: OR
    conditions:
      - "asic_type not in ['mellanox', 'barefoot', 'vs']"
      - https://github.com/sonic-net/sonic-mgmt/issues/8374

vxlan/test_vxlan_bfd_tsa.py:
  skip:
    reason: "VxLAN ECMP BFD TSA test is not yet supported on multi-ASIC platform. Also this test can only run on some platforms."
    conditions:
      - "(is_multi_asic == True) or (platform not in ['x86_64-8102_64h_o-r0', 'x86_64-8101_32fh_o-r0', 'x86_64-mlnx_msn4600c-r0', 'x86_64-mlnx_msn2700-r0', 'x86_64-mlnx_msn2700a1-r0', 'x86_64-kvm_x86_64-r0', 'x86_64-mlnx_msn4700-r0', 'x86_64-nvidia_sn4280-r0'])"

vxlan/test_vxlan_bfd_tsa.py::Test_VxLAN_BFD_TSA::test_tsa_case4:
  skip:
    reason: "VxLAN ECMP BFD TSA test is not yet supported on multi-ASIC platform. Also this test can only run on 4600c, 2700 and 8102. For KVM platform, this test is not supported due to system check not supported currently."
    conditions_logical_operator: OR
    conditions:
      - "(is_multi_asic == True) or (platform not in ['x86_64-8102_64h_o-r0', 'x86_64-8101_32fh_o-r0', 'x86_64-mlnx_msn4600c-r0', 'x86_64-mlnx_msn2700-r0', 'x86_64-mlnx_msn2700a1-r0', 'x86_64-kvm_x86_64-r0', 'x86_64-mlnx_msn4700-r0', 'x86_64-nvidia_sn4280-r0'])"
      - "(asic_type in ['vs']) and https://github.com/sonic-net/sonic-buildimage/issues/19879"

vxlan/test_vxlan_bfd_tsa.py::Test_VxLAN_BFD_TSA::test_tsa_case5:
  skip:
    reason: "VxLAN ECMP BFD TSA test is not yet supported on multi-ASIC platform. Also this test can only run on 4600c, 2700 and 8102. For KVM platform, this test is not supported due to system check not supported currently."
    conditions_logical_operator: OR
    conditions:
      - "(is_multi_asic == True) or (platform not in ['x86_64-8102_64h_o-r0', 'x86_64-8101_32fh_o-r0', 'x86_64-mlnx_msn4600c-r0', 'x86_64-mlnx_msn2700-r0', 'x86_64-mlnx_msn2700a1-r0', 'x86_64-kvm_x86_64-r0', 'x86_64-mlnx_msn4700-r0', 'x86_64-nvidia_sn4280-r0'])"
      - "(asic_type in ['vs']) and https://github.com/sonic-net/sonic-buildimage/issues/19879"

vxlan/test_vxlan_bfd_tsa.py::Test_VxLAN_BFD_TSA::test_tsa_case6:
  skip:
    reason: "VxLAN ECMP BFD TSA test is not yet supported on multi-ASIC platform. Also this test can only run on 4600c, 2700 and 8102. For KVM platform, this test is not supported due to system check not supported currently."
    conditions_logical_operator: OR
    conditions:
      - "(is_multi_asic == True) or (platform not in ['x86_64-8102_64h_o-r0', 'x86_64-8101_32fh_o-r0', 'x86_64-mlnx_msn4600c-r0', 'x86_64-mlnx_msn2700-r0', 'x86_64-mlnx_msn2700a1-r0', 'x86_64-kvm_x86_64-r0', 'x86_64-mlnx_msn4700-r0', 'x86_64-nvidia_sn4280-r0'])"
      - "(asic_type in ['vs']) and https://github.com/sonic-net/sonic-buildimage/issues/19879"

vxlan/test_vxlan_crm.py:
  skip:
    reason: "VxLAN crm test is not yet supported on multi-ASIC platform. Also this test can only run on some platforms."
    conditions:
      - "(is_multi_asic == True) or (platform not in ['x86_64-8102_64h_o-r0', 'x86_64-8101_32fh_o-r0', 'x86_64-mlnx_msn4600c-r0', 'x86_64-mlnx_msn2700-r0', 'x86_64-mlnx_msn2700a1-r0', 'x86_64-kvm_x86_64-r0', 'x86_64-mlnx_msn4700-r0', 'x86_64-nvidia_sn4280-r0'])"

vxlan/test_vxlan_crm.py::Test_VxLAN_Crm::test_crm_128_group_members[v4_in_v6]:
  skip:
    reason: "VxLAN crm test is not yet supported on multi-ASIC platform. Also this test can only run on some platforms. On Mellanox spc1 platform, due to HW limitation, vxlan ipv6 tunnel is not supported"
    conditions_logical_operator: OR
    conditions:
      - "(is_multi_asic == True) or (platform not in ['x86_64-8102_64h_o-r0', 'x86_64-8101_32fh_o-r0', 'x86_64-mlnx_msn4600c-r0', 'x86_64-mlnx_msn2700-r0', 'x86_64-mlnx_msn2700a1-r0', 'x86_64-kvm_x86_64-r0', 'x86_64-mlnx_msn4700-r0', 'x86_64-nvidia_sn4280-r0'])"
      - "asic_gen == 'spc1'"

vxlan/test_vxlan_crm.py::Test_VxLAN_Crm::test_crm_128_group_members[v6_in_v6]:
  skip:
    reason: "VxLAN crm test is not yet supported on multi-ASIC platform. Also this test can only run on some platforms. On Mellanox spc1 platform, due to HW limitation, vxlan ipv6 tunnel is not supported"
    conditions_logical_operator: OR
    conditions:
      - "(is_multi_asic == True) or (platform not in ['x86_64-8102_64h_o-r0', 'x86_64-8101_32fh_o-r0', 'x86_64-mlnx_msn4600c-r0', 'x86_64-mlnx_msn2700-r0', 'x86_64-mlnx_msn2700a1-r0', 'x86_64-kvm_x86_64-r0', 'x86_64-mlnx_msn4700-r0', 'x86_64-nvidia_sn4280-r0'])"
      - "asic_gen == 'spc1'"

vxlan/test_vxlan_crm.py::Test_VxLAN_Crm::test_crm_16k_routes[v4_in_v6]:
  skip:
    reason: "VxLAN crm test is not yet supported on multi-ASIC platform. Also this test can only run on some platforms. On Mellanox spc1 platform, due to HW limitation, vxlan ipv6 tunnel is not supported"
    conditions_logical_operator: OR
    conditions:
      - "(is_multi_asic == True) or (platform not in ['x86_64-8102_64h_o-r0', 'x86_64-8101_32fh_o-r0', 'x86_64-mlnx_msn4600c-r0', 'x86_64-mlnx_msn2700-r0', 'x86_64-mlnx_msn2700a1-r0', 'x86_64-kvm_x86_64-r0', 'x86_64-mlnx_msn4700-r0', 'x86_64-nvidia_sn4280-r0'])"
      - "asic_gen == 'spc1'"

vxlan/test_vxlan_crm.py::Test_VxLAN_Crm::test_crm_16k_routes[v6_in_v6]:
  skip:
    reason: "VxLAN crm test is not yet supported on multi-ASIC platform. Also this test can only run on some platforms. On Mellanox spc1 platform, due to HW limitation, vxlan ipv6 tunnel is not supported"
    conditions_logical_operator: OR
    conditions:
      - "(is_multi_asic == True) or (platform not in ['x86_64-8102_64h_o-r0', 'x86_64-8101_32fh_o-r0', 'x86_64-mlnx_msn4600c-r0', 'x86_64-mlnx_msn2700-r0', 'x86_64-mlnx_msn2700a1-r0', 'x86_64-kvm_x86_64-r0', 'x86_64-mlnx_msn4700-r0', 'x86_64-nvidia_sn4280-r0'])"
      - "asic_gen == 'spc1'"

vxlan/test_vxlan_crm.py::Test_VxLAN_Crm::test_crm_512_nexthop_groups[v4_in_v6]:
  skip:
    reason: "VxLAN crm test is not yet supported on multi-ASIC platform. Also this test can only run on some platforms. On Mellanox spc1 platform, due to HW limitation, vxlan ipv6 tunnel is not supported"
    conditions_logical_operator: OR
    conditions:
      - "(is_multi_asic == True) or (platform not in ['x86_64-8102_64h_o-r0', 'x86_64-8101_32fh_o-r0', 'x86_64-mlnx_msn4600c-r0', 'x86_64-mlnx_msn2700-r0', 'x86_64-mlnx_msn2700a1-r0', 'x86_64-kvm_x86_64-r0', 'x86_64-mlnx_msn4700-r0', 'x86_64-nvidia_sn4280-r0'])"
      - "asic_gen == 'spc1'"

vxlan/test_vxlan_crm.py::Test_VxLAN_Crm::test_crm_512_nexthop_groups[v6_in_v6]:
  skip:
    reason: "VxLAN crm test is not yet supported on multi-ASIC platform. Also this test can only run on some platforms. On Mellanox spc1 platform, due to HW limitation, vxlan ipv6 tunnel is not supported"
    conditions_logical_operator: OR
    conditions:
      - "(is_multi_asic == True) or (platform not in ['x86_64-8102_64h_o-r0', 'x86_64-8101_32fh_o-r0', 'x86_64-mlnx_msn4600c-r0', 'x86_64-mlnx_msn2700-r0', 'x86_64-mlnx_msn2700a1-r0', 'x86_64-kvm_x86_64-r0', 'x86_64-mlnx_msn4700-r0', 'x86_64-nvidia_sn4280-r0'])"
      - "asic_gen == 'spc1'"

vxlan/test_vxlan_ecmp.py:
  skip:
    reason: "VxLAN ECMP test is not yet supported on multi-ASIC platform. Also this test can only run on some platforms."
    conditions:
      - "(is_multi_asic == True) or (platform not in ['x86_64-8102_64h_o-r0', 'x86_64-8101_32fh_o-r0', 'x86_64-mlnx_msn4600c-r0', 'x86_64-mlnx_msn2700-r0', 'x86_64-mlnx_msn2700a1-r0', 'x86_64-kvm_x86_64-r0', 'x86_64-mlnx_msn4700-r0', 'x86_64-nvidia_sn4280-r0'])"

vxlan/test_vxlan_ecmp_switchover.py:
  skip:
    reason: "VxLAN ECMP switchover test is not yet supported on multi-ASIC platform. Also this test can only run on some platforms."
    conditions:
      - "(is_multi_asic == True) or (platform not in ['x86_64-8102_64h_o-r0', 'x86_64-8101_32fh_o-r0', 'x86_64-mlnx_msn4600c-r0', 'x86_64-mlnx_msn2700-r0', 'x86_64-mlnx_msn2700a1-r0', 'x86_64-kvm_x86_64-r0', 'x86_64-mlnx_msn4700-r0', 'x86_64-nvidia_sn4280-r0'])"

#######################################
#####           wan_lacp          #####
#######################################
wan/lacp/test_wan_lag_min_link.py::test_lag_min_link:
  skip:
    reason: "Skip test due to there isn't enough port channel or members exists in current topology."
    conditions_logical_operator: OR
    conditions:
      - "len(minigraph_portchannels) < 2"
      - "not any(len(v['members']) > 1 for _, v in minigraph_portchannels.items())"
