{
  "HWSKU": {
    "Arista-7050QX": ["Arista-7050-QX-32S", "Arista-7050-QX32", "Arista-7050QX-32S-S4Q31", "Arista-7050QX32S-Q32"],
    "Arista-free": ["Arista-7050CX3-32S-C32", "Arista-7260CX3-D108C8"],
    "Arista-frr_bgp": ["Arista-7050CX3-32S", "Arista-7050CX3-32S-C32", "Arista-7050CX3-32S-C28S4",
        "Arista-7060CX-32S-C32", "Arista-7060DX5-32", "Arista-7060DX5-64S", "Arista-7060X6-64DE-64x400G",
        "Arista-7260CX3-C64", "Arista-7260CX3-D108C8"],
    "Arista-frr_zebra": ["Arista-7060CX-32S-C32", "Arista-7260CX3-D108C8"],
    "Arista-monit": ["Arista-720DT-48S", "Arista-7050CX3-32S-C32", "Arista-7260CX3-C64", "Arista-7260CX3-D108C8"]
  },
  "COMMON": [
    {
      "name": "top",
      "cmd": "top -b -n 1",
      "memory_params": {
        "bgpd": {
          "memory_increase_threshold": {
            "type": "value",
            "value": 128
          },
          "memory_high_threshold": null
        },
        "zebra": {
          "memory_increase_threshold": {
            "type": "value",
            "value": 64
          },
          "memory_high_threshold": null
        }
      },
      "memory_check": "parse_top_output"
    },
    {
      "name": "free",
      "cmd": "free -m",
      "memory_params": {
        "used": {
          "memory_increase_threshold": {
            "type": "percentage",
            "value": "20%"
          },
          "memory_high_threshold": null
        }
      },
      "memory_check": "parse_free_output"
    },
    {
      "name": "monit",
      "cmd": "sudo monit status",
      "memory_params": {
        "memory_usage": {
          "memory_increase_threshold": {
            "type": "value",
            "value": 10
          },
          "memory_high_threshold": {
            "type": "value",
            "value": 70
          }
        }
      },
      "memory_check": "parse_monit_status_output"
    },
    {
      "name": "docker",
      "cmd": "docker stats --no-stream",
      "memory_params": {
        "snmp": {
          "memory_increase_threshold": {
            "type": "value",
            "value": 2
          },
          "memory_high_threshold": {
            "type": "value",
            "value": 4
          }
        },
        "pmon": {
          "memory_increase_threshold": {
            "type": "value",
            "value": 2
          },
          "memory_high_threshold": {
            "type": "value",
            "value": 8
          }
        },
        "lldp": {
          "memory_increase_threshold": {
            "type": "value",
            "value": 2
          },
          "memory_high_threshold": {
            "type": "value",
            "value": 4
          }
        },
        "gnmi": {
          "memory_increase_threshold": {
            "type": "value",
            "value": 2
          },
          "memory_high_threshold": {
            "type": "value",
            "value": 6
          }
        },
        "radv": {
          "memory_increase_threshold": {
            "type": "value",
            "value": 2
          },
          "memory_high_threshold": {
            "type": "value",
            "value": 3
          }
        },
        "syncd": {
          "memory_increase_threshold": {
            "type": "value",
            "value": 5
          },
          "memory_high_threshold": {
            "type": "value",
            "value": 18
          }
        },
        "bgp": {
          "memory_increase_threshold": {
            "type": "value",
            "value": 4
          },
          "memory_high_threshold": {
            "type": "value",
            "value": 14
          }
        },
        "teamd": {
          "memory_increase_threshold": {
            "type": "value",
            "value": 2
          },
          "memory_high_threshold": {
            "type": "value",
            "value": 5
          }
        },
        "swss": {
          "memory_increase_threshold": {
            "type": "value",
            "value": 3
          },
          "memory_high_threshold": {
            "type": "value",
            "value": 8
          }
        },
        "database": {
          "memory_increase_threshold": {
            "type": "value",
            "value": 2
          },
          "memory_high_threshold": {
            "type": "value",
            "value": 6
          }
        }
      },
      "memory_check": "parse_docker_stats_output"
    },
    {
      "name": "frr_bgp",
      "cmd": "vtysh -c \"show memory bgp\"",
      "memory_params": {
        "used": {
          "memory_increase_threshold": [
            {"type": "percentage", "value": "50%"},
            {"type": "value", "value": 32}
          ],
          "memory_high_threshold": {
            "type": "value",
            "value": 128
          }
        }
      },
      "memory_check": "parse_frr_memory_output"
    },
    {
      "name": "frr_zebra",
      "cmd": "vtysh -c \"show memory zebra\"",
      "memory_params": {
        "used": {
          "memory_increase_threshold": [
            {"type": "percentage", "value": "50%"},
            {"type": "value", "value": 16}
          ],
          "memory_high_threshold": {
            "type": "value",
            "value": 128
          }
        }
      },
      "memory_check": "parse_frr_memory_output"
    }
  ],
  "Arista-7050QX": [
    {
      "name": "monit",
      "cmd": "sudo monit status",
      "memory_params": {
        "memory_usage": {
          "memory_increase_threshold": {
            "type": "value",
            "value": 10
          },
          "memory_high_threshold": {
            "type": "value",
            "value": 85
          }
        }
      },
      "memory_check": "parse_monit_status_output"
    }
  ],
  "Arista-free": [
    {
      "name": "free",
      "cmd": "free -m",
      "memory_params": {
        "used": {
          "memory_increase_threshold": {
            "type": "percentage",
            "value": "120%"
          },
          "memory_high_threshold": null
        }
      },
      "memory_check": "parse_free_output"
    }
  ],
  "Arista-frr_bgp": [
    {
      "name": "frr_bgp",
      "cmd": "vtysh -c \"show memory bgp\"",
      "memory_params": {
        "used": {
          "memory_increase_threshold": [
            {"type": "value", "value": 64}
          ],
          "memory_high_threshold": {
            "type": "value",
            "value": 200
          }
        }
      },
      "memory_check": "parse_frr_memory_output"
    }
  ],
  "Arista-frr_zebra": [
    {
      "name": "frr_zebra",
      "cmd": "vtysh -c \"show memory zebra\"",
      "memory_params": {
        "used": {
          "memory_increase_threshold": [
            {"type": "value", "value": 48}
          ],
          "memory_high_threshold": {
            "type": "value",
            "value": 128
          }
        }
      },
      "memory_check": "parse_frr_memory_output"
    }
  ],
  "Arista-monit": [
    {
      "name": "monit",
      "cmd": "sudo monit status",
      "memory_params": {
        "memory_usage": {
          "memory_increase_threshold": {
            "type": "value",
            "value": 30
          },
          "memory_high_threshold": {
            "type": "value",
            "value": 70
          }
        }
      },
      "memory_check": "parse_monit_status_output"
    }
  ]
}
